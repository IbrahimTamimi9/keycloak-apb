FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"bmFtZToga2V5Y2xvYWstYXBiCmltYWdlOiBmZWVkaGVucnkva2V5Y2xvYWstYXBiCmRlc2NyaXB0\
aW9uOiBLZXljbG9hayAtIE9wZW4gU291cmNlIElkZW50aXR5IGFuZCBBY2Nlc3MgTWFuYWdlbWVu\
dApiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwKdGFnczogCiAgLSBtb2JpbGUtc2Vydmlj\
ZQptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogS2V5Y2xvYWsKICBjb25zb2xlLm9wZW5zaGlmdC5p\
by9pY29uQ2xhc3M6IGZhIGZhLXVzZXJzCiAgc2VydmljZU5hbWU6IGtleWNsb2FrCnBsYW5zOgog\
IC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlcGxveSBrZXljbG9hawogICAgZnJl\
ZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOiAKICAgIC0gbmFtZTogQURN\
SU5fTkFNRQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICBkZWZhdWx0OiBhZG1pbgogICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEtleWNsb2FrIGFkbWluIHVzZXJuYW1lCiAgICAtIG5h\
bWU6IEFETUlOX1BBU1NXT1JECiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIGRlZmF1bHQ6IGFk\
bWluCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogS2V5Y2xvYWsgYWRtaW4gcGFzc3dv\
cmQKICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTogc2VydmljZQogICAgICB0aXRsZTog\
U2VydmljZSBjbGllbnQgaXMgZm9yCiAgICAgIHR5cGU6IHN0cmluZw=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
